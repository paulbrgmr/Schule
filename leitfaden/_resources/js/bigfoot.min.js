(function(){!function($){return $.bigfoot=function(t){var o,e,n,i,a,r,s,l,f,c,d,u,p,g,h,v,b,m,O,_,C,T,y,w,F,x,N;return n=void 0,f={actionOriginalFN:"hide",activateCallback:function(){},activateOnHover:!1,allowMultipleFN:!1,anchorPattern:/(fn|footnote|note)[:\-_\d]/gi,anchorParentTagname:"sup",breakpoints:{},deleteOnUnhover:!1,footnoteParentClass:"footnote",footnoteTagname:"li",hoverDelay:250,numberResetSelector:void 0,popoverDeleteDelay:300,popoverCreateDelay:100,positionContent:!0,preventPageScroll:!0,scope:!1,useFootnoteOnlyOnce:!0,contentMarkup:'<aside class="bigfoot-footnote is-positioned-bottom" data-footnote-number="{{FOOTNOTENUM}}" data-footnote-identifier="{{FOOTNOTEID}}" alt="Footnote {{FOOTNOTENUM}}"> <div class="bigfoot-footnote__wrapper"> <div class="bigfoot-footnote__content"> {{FOOTNOTECONTENT}} </div></div> <div class="bigfoot-footnote__tooltip"></div> </aside>',buttonMarkup:'<div class=\'bigfoot-footnote__container\'> <button class="bigfoot-footnote__button" id="{{SUP:data-footnote-backlink-ref}}" data-footnote-number="{{FOOTNOTENUM}}" data-footnote-identifier="{{FOOTNOTEID}}" alt="See Footnote {{FOOTNOTENUM}}" rel="footnote" data-bigfoot-footnote="{{FOOTNOTECONTENT}}"> <svg class="bigfoot-footnote__button__circle" viewbox="0 0 6 6" preserveAspectRatio="xMinYMin"><circle r="3" cx="3" cy="3" fill="white"></circle></svg> <svg class="bigfoot-footnote__button__circle" viewbox="0 0 6 6" preserveAspectRatio="xMinYMin"><circle r="3" cx="3" cy="3" fill="white"></circle></svg> <svg class="bigfoot-footnote__button__circle" viewbox="0 0 6 6" preserveAspectRatio="xMinYMin"><circle r="3" cx="3" cy="3" fill="white"></circle></svg> </button></div>'},y=$.extend(f,t),h={},u=function(){var t,o,e,n,i,a,s,l,f,d,u,p,g,h,v,m,O,C,T,w;for(u=y.scope?""+y.scope+' a[href*="#"]':'a[href*="#"]',e=$(u).filter(function(){var t,o;return t=$(this),o=t.attr("rel"),("null"===o||null==o)&&(o=""),(""+t.attr("href")+o).match(y.anchorPattern)&&t.closest("[class*="+y.footnoteParentClass+"]:not(a):not("+y.anchorParentTagname+")").length<1}),m=[],h=[],f=[],r(e,h),$(h).each(function(){var t,o;return o=$(this).data("footnote-ref").replace(/[:.+~*\]\[]/g,"\\$&"),y.useFootnoteOnlyOnce&&(o=""+o+":not(.footnote-processed)"),t=$(o).closest(y.footnoteTagname),t.length>0?(m.push(t.first().addClass("footnote-processed")),f.push(this)):void 0}),o=$("[data-footnote-identifier]:last"),g=o.length<1?0:+o.data("footnote-identifier"),w=[],O=C=0,T=m.length;T>=0?T>C:C>T;O=T>=0?++C:--C)switch(p=b($(m[O]).html().trim(),$(f[O]).data("footnote-backlink-ref")),p=p.replace(/"/g,"&quot;").replace(/&lt;/g,"&ltsym;").replace(/&gt;/g,"&gtsym;"),g+=1,d="",s=$(f[O]),l=$(m[O]),null!=y.numberResetSelector?(t=s.closest(y.numberResetSelector),t.is(i)?v+=1:v=1,i=t):v=g,0!==p.indexOf("<")&&(p="<p>"+p+"</p>"),d=y.buttonMarkup.replace(/\{\{FOOTNOTENUM\}\}/g,v).replace(/\{\{FOOTNOTEID\}\}/g,g).replace(/\{\{FOOTNOTECONTENT\}\}/g,p),d=_(d,"SUP",s),d=_(d,"FN",l),n=$(d).insertBefore(s),a=l.parent(),y.actionOriginalFN.toLowerCase()){case"hide":s.addClass("footnote-print-only"),l.addClass("footnote-print-only"),w.push(c(a));break;case"delete":s.remove(),l.remove(),w.push(c(a));break;default:w.push(s.addClass("footnote-print-only"))}return w},r=function(t,o){var e,n,i,a;null==o&&(o=[]),e=void 0,n=void 0,i=void 0,a=void 0,t.each(function(){var t,n;return n=$(this),i="#"+n.attr("href").split("#")[1],e=n.closest(y.anchorParentTagname),t=n.find(y.anchorParentTagname),e.length>0?(a=(e.attr("id")||"")+(n.attr("id")||""),o.push(e.attr({"data-footnote-backlink-ref":a,"data-footnote-ref":i}))):t.length>0?(a=(t.attr("id")||"")+(n.attr("id")||""),o.push(n.attr({"data-footnote-backlink-ref":a,"data-footnote-ref":i}))):(a=n.attr("id")||"",o.push(n.attr({"data-footnote-backlink-ref":a,"data-footnote-ref":i})))})},c=function(t){var o;return o=void 0,t.is(":empty")||0===t.children(":not(.footnote-print-only)").length?(o=t.parent(),"delete"===y.actionOriginalFN.toLowerCase()?t.remove():t.addClass("footnote-print-only"),c(o)):t.children(":not(.footnote-print-only)").length===t.children("hr:not(.footnote-print-only)").length?(o=t.parent(),"delete"===y.actionOriginalFN.toLowerCase()?t.remove():(t.children("hr").addClass("footnote-print-only"),t.addClass("footnote-print-only")),c(o)):void 0},b=function(t,o){var e;return o.indexOf(" ")>=0&&(o=o.trim().replace(/\s+/g,"|").replace(/(.*)/g,"($1)")),e=new RegExp("(\\s|&nbsp;)*<\\s*a[^#<]*#"+o+"[^>]*>(.*?)<\\s*/\\s*a>","g"),t.replace(e,"").replace("[]","")},_=function(t,o,e){var n,i,a,r;for(i=new RegExp("\\{\\{"+o+":([^\\}]*)\\}\\}","g"),n=void 0,r=void 0,a=void 0,n=i.exec(t);n;)n[1]&&(r=e.attr(n[1])||"",t=t.replace("{{"+o+":"+n[1]+"}}",r)),n=i.exec(t);return t},i=function(t){var o,e,n;if(y.activateOnHover){if(o=$(t.target).closest(".bigfoot-footnote__button"),e='[data-footnote-identifier="'+o.attr("data-footnote-identifier")+'"]',o.hasClass("is-active"))return;o.addClass("is-hover-instantiated"),y.allowMultipleFN||(n=".bigfoot-footnote:not("+e+")",O(n)),l(".bigfoot-footnote__button"+e).addClass("is-hover-instantiated")}},w=function(t){var o,e,n;n=$(t.target),o=n.closest(".bigfoot-footnote__button"),e=n.closest(".bigfoot-footnote"),o.length>0?(t.preventDefault(),s(o)):e.length<1&&$(".bigfoot-footnote").length>0&&O()},s=function(t){var o;t.blur(),o='data-footnote-identifier="'+t.attr("data-footnote-identifier")+'"',t.hasClass("changing")||(t.hasClass("is-active")?y.allowMultipleFN?O(".bigfoot-footnote["+o+"]"):O():(t.addClass("changing"),setTimeout(function(){return t.removeClass("changing")},y.popoverCreateDelay),l(".bigfoot-footnote__button["+o+"]"),t.addClass("is-click-instantiated"),y.allowMultipleFN||O(".bigfoot-footnote:not(["+o+"])")))},l=function(t){var o,e;return o=void 0,o="string"!=typeof t&&y.allowMultipleFN?t:"string"!=typeof t?t.first():y.allowMultipleFN?$(t).closest(".bigfoot-footnote__button"):$(t+":first").closest(".bigfoot-footnote__button"),e=$(),o.each(function(){var t,n,i,r;i=$(this),r=void 0;try{return r=y.contentMarkup.replace(/\{\{FOOTNOTENUM\}\}/g,i.attr("data-footnote-number")).replace(/\{\{FOOTNOTEID\}\}/g,i.attr("data-footnote-identifier")).replace(/\{\{FOOTNOTECONTENT\}\}/g,i.attr("data-bigfoot-footnote")).replace(/\&gtsym\;/g,"&gt;").replace(/\&ltsym\;/g,"&lt;"),r=_(r,"BUTTON",i)}finally{t=$(r);try{y.activateCallback(t,i)}catch(s){}t.insertAfter(o),h[i.attr("data-footnote-identifier")]="init",t.attr("bigfoot-max-width",a(t.css("max-width"),t)),t.css("max-width",1e4),n=t.find(".bigfoot-footnote__content"),t.attr("data-bigfoot-max-height",a(n.css("max-height"),n)),C(),i.addClass("is-active"),t.find(".bigfoot-footnote__content").bindScrollHandler(),e=e.add(t)}}),setTimeout(function(){return e.addClass("is-active")},y.popoverCreateDelay),e},e=function(){var t,o;return t=document.createElement("div"),t.style.cssText="display:inline-block;padding:0;line-height:1;position:absolute;visibility:hidden;font-size:1em;",t.appendChild(document.createElement("M")),document.body.appendChild(t),o=t.offsetHeight,document.body.removeChild(t),o},a=function(t,o){return"none"===t?t=1e4:t.indexOf("rem")>=0?t=parseFloat(t)*e():t.indexOf("em")>=0?t=parseFloat(t)*parseFloat(o.css("font-size")):t.indexOf("px")>=0?(t=parseFloat(t),60>=t&&(t/=parseFloat(o.parent().css("width")))):t.indexOf("%")>=0&&(t=parseFloat(t)/100),t},$.fn.bindScrollHandler=function(){return y.preventPageScroll?($(this).on("DOMMouseScroll mousewheel",function(t){var o,e,n,i,a,r,s,l;return e=$(this),s=e.scrollTop(),r=e[0].scrollHeight,i=parseInt(e.css("height")),o=e.closest(".bigfoot-footnote"),e.scrollTop()>0&&e.scrollTop()<10&&o.addClass("is-scrollable"),o.hasClass("is-scrollable")?(n="DOMMouseScroll"===t.type?-40*t.originalEvent.detail:t.originalEvent.wheelDelta,l=n>0,a=function(){return t.stopPropagation(),t.preventDefault(),t.returnValue=!1,!1},!l&&-n>r-i-s?(e.scrollTop(r),o.addClass("is-fully-scrolled"),a()):l&&n>s?(e.scrollTop(0),o.removeClass("is-fully-scrolled"),a()):o.removeClass("is-fully-scrolled")):void 0}),$(this)):$(this)},F=function(t){return y.deleteOnUnhover&&y.activateOnHover?setTimeout(function(){var o;return o=$(t.target).closest(".bigfoot-footnote, .bigfoot-footnote__button"),$(".bigfoot-footnote__button:hover, .bigfoot-footnote:hover").length<1?O():void 0},y.hoverDelay):void 0},d=function(t){return 27===t.keyCode?O():void 0},O=function(t,o){var e,n,i,a;return null==t&&(t=".bigfoot-footnote"),null==o&&(o=y.popoverDeleteDelay),e=$(),a=void 0,n=void 0,i=void 0,$(t).each(function(){return i=$(this),a=i.attr("data-footnote-identifier"),n=$('.bigfoot-footnote__button[data-footnote-identifier="'+a+'"]'),n.hasClass("changing")?void 0:(e=e.add(n),n.removeClass("is-active is-hover-instantiated is-click-instantiated").addClass("changing"),i.removeClass("is-active").addClass("disapearing"),setTimeout(function(){return i.remove(),delete h[a],n.removeClass("changing")},o))}),e},C=function(t){var o;y.positionContent&&(o=t?t.type:"resize",$(".bigfoot-footnote").each(function(){var t,e,n,i,a,r,s,l,f,c,d,u,p,g,b,m;return i=$(this),r=i.attr("data-footnote-identifier"),a='data-footnote-identifier="'+r+'"',e=i.find(".bigfoot-footnote__content"),t=i.siblings(".bigfoot-footnote__button"),b=T(t),l=parseFloat(i.css("margin-top")),f=+i.attr("data-bigfoot-max-height"),m=2*l+i.outerHeight(),c=1e4,p=b.bottomRoom<m&&b.topRoom>b.bottomRoom,s=h[r],p?("top"!==s&&(h[r]="top",i.addClass("is-positioned-top").removeClass("is-positioned-bottom"),i.css("transform-origin",100*b.leftRelative+"% 100%")),c=b.topRoom-l-15):(("bottom"!==s||"init"===s)&&(h[r]="bottom",i.removeClass("is-positioned-top").addClass("is-positioned-bottom"),i.css("transform-origin",100*b.leftRelative+"% 0%")),c=b.bottomRoom-l-15),i.find(".bigfoot-footnote__content").css({"max-height":Math.min(c,f)+"px"}),"resize"===o&&(u=parseFloat(i.attr("bigfoot-max-width")),n=i.find(".bigfoot-footnote__wrapper"),d=u,1>=u&&(g=function(){var t,o;return o=1e4,y.maxWidthRelativeTo&&(t=$(y.maxWidthRelativeTo),t.length>0&&(o=t.outerWidth())),Math.min(window.innerWidth,o)}(),d=g*u),d=Math.min(d,i.find(".bigfoot-footnote__content").outerWidth()+1),n.css("max-width",d+"px"),i.css({left:-b.leftRelative*d+parseFloat(t.css("margin-left"))+t.outerWidth()/2+"px"}),v(i,b.leftRelative)),parseInt(i.outerHeight())<i.find(".bigfoot-footnote__content")[0].scrollHeight?i.addClass("is-scrollable"):void 0}))},v=function(t,o){var e;null==o&&(o=.5),e=t.find(".bigfoot-footnote__tooltip"),e.length>0&&e.css("left",""+100*o+"%")},T=function(t){var o,e,n,i,a,r;return e=parseFloat(t.css("margin-left")),n=parseFloat(t.outerWidth())-e,o=parseFloat(t.outerHeight()),r=N(),a=t.offset().top-r.scrollY+o/2,i=t.offset().left-r.scrollX+n/2,{topRoom:a,bottomRoom:r.height-a,leftRoom:i,rightRoom:r.width-i,leftRelative:i/r.width,topRelative:a/r.height}},N=function(){var t;return t=$(window),{width:window.innerWidth,height:window.innerHeight,scrollX:t.scrollLeft(),scrollY:t.scrollTop()}},o=function(t,o,e,i,a){var r,s,l,f,c,d,u;return null==i&&(i=y.popoverDeleteDelay),null==a&&(a=!0),f=void 0,s=void 0,d=void 0,"string"==typeof t?(d="iphone"===t.toLowerCase()?"<320px":"ipad"===t.toLowerCase()?"<768px":t,s=">"===d.charAt(0)?"min":"<"===d.charAt(0)?"max":null,c=s?"("+s+"-width: "+d.substring(1)+")":d,f=window.matchMedia(c)):f=t,f.media&&"invalid"===f.media?{added:!1,mq:f,listener:null}:(u="min"===s,r="max"===s,o=o||g(a,i,u,function(t){return t.addClass("is-bottom-fixed")}),e=e||g(a,i,r,function(){}),l=function(t){t.matches?o(a,n):e(a,n)},f.addListener(l),l(f),y.breakpoints[t]={added:!0,mq:f,listener:l},y.breakpoints[t])},g=function(t,o,e,n){return function(t,i){var a;return a=void 0,t&&(a=i.close(),i.updateSetting("activateCallback",n)),setTimeout(function(){return i.updateSetting("positionContent",e),t?i.activate(a):void 0},o)}},m=function(t,o){var e,n,i,a;if(i=null,e=void 0,a=!1,"string"==typeof t)a=void 0!==y.breakpoints[t];else for(e in y.breakpoints)y.breakpoints.hasOwnProperty(e)&&y.breakpoints[e].mq===t&&(a=!0);return a&&(n=y.breakpoints[e||t],o?o({matches:!1}):n.listener({matches:!1}),n.mq.removeListener(n.listener),delete y.breakpoints[e||t]),a},x=function(t,o){var e,n;if(e=void 0,"string"==typeof t)e=y[t],y[t]=o;else{e={};for(n in t)t.hasOwnProperty(n)&&(e[n]=y[n],y[n]=t[n])}return e},p=function(t){return y[t]},$(document).ready(function(){return u(),$(document).on("mouseenter",".bigfoot-footnote__button",i),$(document).on("touchend click",w),$(document).on("mouseout",".is-hover-instantiated",F),$(document).on("keyup",d),$(window).on("scroll resize",C),$(document).on("gestureend",function(){return C()})}),n={removePopovers:O,close:O,createPopover:l,activate:l,repositionFeet:C,reposition:C,addBreakpoint:o,removeBreakpoint:m,getSetting:p,updateSetting:x}}}(jQuery)}).call(this);
//# sourceMappingURL=./bigfoot.min.js.map